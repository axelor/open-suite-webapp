import{L as l,a as p,g as y,b as d,t as f}from"./index-CYAzAkrO.js";const w=new l;async function g(t){const a=`ws/search/menu${t?`?parent=${t}`:""}`;return await w.get(a,async()=>{const e=await p({url:a,method:"GET"});if(e.ok){const{status:n,data:r}=await e.json();return n===0?r??[]:[]}return[]})}async function E({data:t,limit:s}){const a=await p({url:"ws/search",method:"POST",body:{data:t,limit:s}});if(a.ok){const{status:e,data:n=[]}=await a.json();return e===0?n:[]}return Promise.reject(500)}function h(t){return(t||[]).reduce((s,a)=>{const e={...a,type:a.type?.toUpperCase?.()};return e.type==="REFERENCE"&&(e.type="MANY_TO_ONE",e.canNew="false",e.canEdit="false",e.multiple&&(e.type="ONE_TO_MANY",e.widget="tag-select")),(e.selection||e.selectionList)&&!e.widget&&(e.widget="Selection"),e.serverType=y({...e,type:"field"},e)??"STRING",e.widget=d(e,null),["INTEGER","LONG","DECIMAL"].includes(e.serverType)&&(e.nullable=!0),e.name?{...s,[e.name]:{...e,type:"field"}}:s},{})}function u(t){switch(t.items?t.items?.forEach(u):t.canDirty=!1,f(t.widget??t.serverType??t.type)){case"many-to-one":case"one-to-one":case"suggest-box":t.canNew=!1,t.canEdit=!1;break;case"one-to-many":case"many-to-many":case"master-detail":t.hidden=!0;break}}function N(t){const{model:s,view:a}=t,{name:e,title:n}=a,{searchFields:r=[]}=a,c=h(r);return{...t,view:{type:"form",model:s,items:[{colSpan:12,name:e,type:"panel",title:n,showFrame:!0,items:(()=>{const o=r.map(i=>({...i,...c[i.name??""]}));return o.forEach(u),o})()}]},fields:c}}export{u as a,h as b,g as f,N as p,E as s};
